{"componentChunkName":"component---src-templates-post-jsx","path":"/osiv/","result":{"data":{"site":{"siteMetadata":{"title":"나누면 배가 되고"}},"markdownRemark":{"id":"cf3a2936-1b1f-5d11-832e-dbb9f8051755","excerpt":"OSIV OSIV는 Open Session In View의 준말로, 영속성 컨텍스트를 뷰까지 열어둔다는 것을 의미이다. 영속성 컨텍스트가 유지된다는 의미는 뷰에서도 과 같이 영속성 컨텍스트의 이점을 누릴 수 있다는 것이다. 요청 당 트랜잭션 OSIV의 핵심은 뷰에서도 이 가능하도록 하는 것이다. 가장 단순한 방법은 요청이 들어오자 마자  혹은 를 거치는 …","html":"<h2>OSIV</h2>\n<p>OSIV는 Open Session In View의 준말로, 영속성 컨텍스트를 뷰까지 열어둔다는 것을 의미이다. 영속성 컨텍스트가 유지된다는 의미는 뷰에서도 <code class=\"language-text\">Lazy Loading</code>과 같이 영속성 컨텍스트의 이점을 누릴 수 있다는 것이다.</p>\n<h2>요청 당 트랜잭션</h2>\n<p>OSIV의 핵심은 뷰에서도 <code class=\"language-text\">Lazy Loading</code>이 가능하도록 하는 것이다. 가장 단순한 방법은 요청이 들어오자 마자 <code class=\"language-text\">Filter</code> 혹은 <code class=\"language-text\">Interceptor</code>를 거치는 시점에 <code class=\"language-text\">트랜잭션을 시작</code>하고 요청이 끝날 때 <code class=\"language-text\">트랜잭션을 종료</code>하는 것이다. 이것을 <code class=\"language-text\">요청 당 트랜잭션 방식</code>의 <code class=\"language-text\">OSIV</code>라 하며 초창기에 사용되던 방식이다. 이것을 그림으로 표현하면 아래와 같다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/e6a58eb0eac64c15b448f34389d3b65a/d4913/1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABDklEQVR42l2R7a6CYAyDuf+bk8QISsKnCioiIFFDAOt5lrz8OEsaYGxdu3n6i3me9Xw+9Xg81DSN7ve7oaoq5XluKIpCaZrqeDzqdrutuF6v9jydThrHUR6Ey7KsZK4QwizLtNlstNvtdDgc5Pu+oihS13WGvu/1+Xz0fr+t/vV6yft+vxqGQXVdKwxDxXFsP9q21eVyMXW800hNWZY6n89G4pSRQyk1Huqwg5XtdmukDMBukiTa7/erNcjJUYsjHKCcPMONEMsoghgbSEcRBCghjwvArgE5tyryBD1mmQ8Owk+K2QvTsEER4Zr+B3lIOAYCWIMRooxmiJ09R8gAdwRsAvKAnQZBYOBY0zTpBx1mEWlRyTAmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='1' title='' src='/static/e6a58eb0eac64c15b448f34389d3b65a/ca1dc/1.png' srcset='/static/e6a58eb0eac64c15b448f34389d3b65a/e7570/1.png 170w,\n/static/e6a58eb0eac64c15b448f34389d3b65a/f46e7/1.png 340w,\n/static/e6a58eb0eac64c15b448f34389d3b65a/ca1dc/1.png 680w,\n/static/e6a58eb0eac64c15b448f34389d3b65a/02d09/1.png 1020w,\n/static/e6a58eb0eac64c15b448f34389d3b65a/9d567/1.png 1360w,\n/static/e6a58eb0eac64c15b448f34389d3b65a/d4913/1.png 1794w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>그림을 살펴보면 요청부터 응답까지 영속성 컨텍스트의 생존 범위가 늘어나게 된다. 이제 뷰에서도 <code class=\"language-text\">Lazy Loading</code>을 진행할 수 있지만 몇 가지 단점을 가지고 있다. </p>\n<p>먼저 뷰에서도 엔티티의 수정이 가능해진다. 영속성 컨텍스트의 범위가 늘어나기 때문에 뷰에서 엔티티의 수정이 일어나면 <code class=\"language-text\">Dirty Checking</code> 과정을 통해 응답 시점에, 즉 트랜잭션이 끝나는 시점에 데이터베이스에 반영된다.</p>\n<p>뷰에서 데이터를 수정하는 것의 가장 큰 문제는 데이터의 변경 지점을 찾기 어렵게 만든다는 것이다. 비즈니스 로직이 담긴 서비스 계층에서 데이터를 수정한 뒤 영속하는 것은 당연한 것 처럼 받아들일 수 있다. 보통 서비스 계층에서 로직을 시작할 때 <code class=\"language-text\">@Transactional</code> 애노테이션을 통해 선언적 트랜잭션을 명시한 후 비즈니스 로직을 수행한다. 하지만 뷰에서의 엔티티 속성 변경으로 데이터베이스에 영속되는 것은 우리가 뷰에게 원하는 방향은 아니다.</p>\n<p>또한 데이터베이스 관련 로직이 필요하지 않은 부분에도 <code class=\"language-text\">불필요하게 데이터베이스 커넥션이 활용</code>될 수 있다. 요청 당 트랜잭션은 요청과 동시에 데이터베이스 커넥션을 커넥션 풀에서 획득한다. 결국 트랜잭션이 끝나는 응답 시점까지 데이터베이스 커넥션을 물고 있는 것이다. 해당 로직 내에서 데이터베이스와 관련된 로직이 처리되지 않는다면 <code class=\"language-text\">불필요한 커넥션 자원을 낭비</code>하고 있는 것과 다름 없다.</p>\n<h2>비즈니스 계층 트랜잭션</h2>\n<p>요청과 동시에 트랜잭션을 획득하는 요청 당 트랜잭션은 많은 단점을 가지고 있다. 스프링에서는 이러한 단점을 개선하기 위해 비즈니스 계층 트랜잭션을 제공하고 있다.</p>\n<h3>OpenSessionInViewFilter</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>orm<span class=\"token punctuation\">.</span>hibernate5<span class=\"token punctuation\">.</span>support</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OpenSessionInViewFilter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">OncePerRequestFilter</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>하이버네이트 OSIV 서블릿 필터이다. OpenSessionViewFilter는 필터 내에 Session을 오픈 하지만 트랜잭션은 시작하지 않는다. 트랜잭션을 시작하지 않기 때문에 실제 데이터베이스의 커넥션을 획득하지 않는다. Session은 생성되기 때문에 <code class=\"language-text\">영속성 컨텍스트만 생성</code>된다.</p>\n<h3>OpenSessionInViewInterceptor</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>orm<span class=\"token punctuation\">.</span>hibernate5<span class=\"token punctuation\">.</span>support</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OpenSessionInViewInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AsyncWebRequestInterceptor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>하이버네이트 OSIV 스프링 인터셉터이다. Filter와 동일하게 Interceptor에서 Session은 오픈 하지만 트랜잭션은 시작하지 않는다.</p>\n<h3>OpenEntityManagerInViewFilter</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>orm<span class=\"token punctuation\">.</span>jpa<span class=\"token punctuation\">.</span>support</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OpenEntityManagerInViewFilter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">OncePerRequestFilter</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JPA에서 제공하는 OSIV 서블릿 필터이다.</p>\n<h3>OpenEntityManagerInViewInterceptor</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>orm<span class=\"token punctuation\">.</span>jpa<span class=\"token punctuation\">.</span>support</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OpenEntityManagerInViewInterceptor</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">EntityManagerFactoryAccessor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AsyncWebRequestInterceptor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JPA에서 제공하는 OSIV 스프링 인터셉터이다. </p>\n<p>이제 위 객체들을 필요에 따라 필터 혹은 인터셉터에 등록하여 사용하면 된다. </p>\n<p>스프링 부트는 <code class=\"language-text\">application properties</code> 설정 중 <code class=\"language-text\">spring.jpa.open-in-view</code>을 통해 지정이 가능하다. </p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">jpa</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">open-in-view</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>아래는 스프링 부트에서 OSIV 관련 설정을 자동으로 해주는 <code class=\"language-text\">JpaWebConfiguration</code>이다. </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span><span class=\"token punctuation\">(</span>proxyBeanMethods <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@EnableConfigurationProperties</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JpaProperties</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JpaBaseConfiguration</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">BeanFactoryAware</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token annotation punctuation\">@Configuration</span><span class=\"token punctuation\">(</span>proxyBeanMethods <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token annotation punctuation\">@ConditionalOnWebApplication</span><span class=\"token punctuation\">(</span>type <span class=\"token operator\">=</span> <span class=\"token class-name\">Type</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SERVLET</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token annotation punctuation\">@ConditionalOnClass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebMvcConfigurer</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token annotation punctuation\">@ConditionalOnMissingBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token class-name\">OpenEntityManagerInViewInterceptor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">OpenEntityManagerInViewFilter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token annotation punctuation\">@ConditionalOnMissingFilterBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OpenEntityManagerInViewFilter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token annotation punctuation\">@ConditionalOnProperty</span><span class=\"token punctuation\">(</span>prefix <span class=\"token operator\">=</span> <span class=\"token string\">\"spring.jpa\"</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">\"open-in-view\"</span><span class=\"token punctuation\">,</span> havingValue <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">,</span> matchIfMissing <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">protected</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JpaWebConfiguration</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Log</span> logger <span class=\"token operator\">=</span> <span class=\"token class-name\">LogFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLog</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JpaWebConfiguration</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JpaProperties</span> jpaProperties<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">protected</span> <span class=\"token class-name\">JpaWebConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JpaProperties</span> jpaProperties<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jpaProperties <span class=\"token operator\">=</span> jpaProperties<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token annotation punctuation\">@Bean</span>\n\t\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">OpenEntityManagerInViewInterceptor</span> <span class=\"token function\">openEntityManagerInViewInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jpaProperties<span class=\"token punctuation\">.</span><span class=\"token function\">getOpenInView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\tlogger<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"spring.jpa.open-in-view is enabled by default. \"</span>\n\t\t\t\t\t\t<span class=\"token operator\">+</span> <span class=\"token string\">\"Therefore, database queries may be performed during view \"</span>\n\t\t\t\t\t\t<span class=\"token operator\">+</span> <span class=\"token string\">\"rendering. Explicitly configure spring.jpa.open-in-view to disable this warning\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OpenEntityManagerInViewInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token annotation punctuation\">@Bean</span>\n\t\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">WebMvcConfigurer</span> <span class=\"token function\">openEntityManagerInViewInterceptorConfigurer</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token class-name\">OpenEntityManagerInViewInterceptor</span> interceptor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebMvcConfigurer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t\t\t<span class=\"token annotation punctuation\">@Override</span>\n\t\t\t\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addInterceptors</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InterceptorRegistry</span> registry<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\tregistry<span class=\"token punctuation\">.</span><span class=\"token function\">addWebRequestInterceptor</span><span class=\"token punctuation\">(</span>interceptor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">ConditionalOnProperty</code>: Property의 조건에 따라 작동하는 <code class=\"language-text\">Bean</code>이다. application.yml에 있는 값을 기준으로 Bean을 생성한다.</li>\n</ul>\n<p>간단히 코드를 살펴보면 <code class=\"language-text\">OpenEntityManagerInViewInterceptor</code>를 빈으로 등록하는 것을 확인할 수 있다. 자세한 동작 과정은 추후 살펴보려한다.</p>\n<p>무튼 스프링에서 제공하는 OSIV를 사용하면 트랜잭션의 범위를 비즈니스 계층으로 좁힐 수 있다. 그림으로 표현하면 아래와 같다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/2eed7c0ce0999c40e43b5eab6e1452cb/f766a/2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABIklEQVR42o1S14qFUAz0/79NEQQvPth7L9hr1gn3yC77YiBGk5zJZDwSvbRt29j3ff/jyC3Lwu8w6Q3YdV00TRMVRUFxHJPv+xQEAXmeR1EUUV3XnAMoA57n+UzDYZj4Po6D1nWlPM/JsixSVZU+nw+ZpkmapnFuHEfKsoz7JDz6vifbtslxHGaBHBrAIgxDaprm+QaTNE0ZBOzAEjkwBwGpLEsuGIbBniQJVVX1NANQRAAhj8P1PcS9CXi3R98aAwqdhmHg5rZtWRPXdanrOq4hCuHBHhKxLLcckAQiic0kaCZ0wxpgjNUwURiGiL/42wA8zzPX/jGEoQi9MA2MhSGHQYhgD0kQsZEsy6QoCum6zgNeXxtxD4VjPTADyPFdHfYD0YizT/35dEYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='2' title='' src='/static/2eed7c0ce0999c40e43b5eab6e1452cb/ca1dc/2.png' srcset='/static/2eed7c0ce0999c40e43b5eab6e1452cb/e7570/2.png 170w,\n/static/2eed7c0ce0999c40e43b5eab6e1452cb/f46e7/2.png 340w,\n/static/2eed7c0ce0999c40e43b5eab6e1452cb/ca1dc/2.png 680w,\n/static/2eed7c0ce0999c40e43b5eab6e1452cb/02d09/2.png 1020w,\n/static/2eed7c0ce0999c40e43b5eab6e1452cb/9d567/2.png 1360w,\n/static/2eed7c0ce0999c40e43b5eab6e1452cb/f766a/2.png 1808w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>요청이 들어오면 OSIV 설정 정보에 따라 필터 혹은 인터셉터에서 <code class=\"language-text\">영속성 컨텍스트</code>를 생성한다. 여기서 중요한 것은 트랜잭션을 시작하지 않는다는 것이다. </p>\n<p>그렇다면 트랜잭션은 언제 시작할까? 바로 서비스 계층에서 <code class=\"language-text\">@Transactional</code>을 마주할 때 미리 생성한 영속성 컨텍스트를 기반으로 시작한다.</p>\n<p>그 다음 서비스 계층에서 모든 트랜잭션이 마무리되면 트랜잭션을 커밋한다. 단 <code class=\"language-text\">영속성 컨텍스트</code>는 지속된다. 영속성 컨텍스트는 OSIV로 지정한 범위까지 유지된다. 이때 영속성 컨텍스트를 종료하지만 <code class=\"language-text\">flush()</code>는 호출되지 않는다.</p>\n<p>정리하면 아래와 같다.</p>\n<ul>\n<li>영속성 컨텍스트가 트랜잭션 범위 내에 있으면 엔티티를 <code class=\"language-text\">조회</code>하고 <code class=\"language-text\">수정</code>할 수 있다.</li>\n<li>영속성 컨텍스트가 트랜잭션 범위 밖에 위치하면 엔티티 <code class=\"language-text\">조회</code>만 가능하다. 즉 <code class=\"language-text\">Lazy Loading</code>이 가능하다는 것을 의미한다.</li>\n</ul>\n<h2>OSIV를 사용하며 직면한 문제</h2>\n<p><code class=\"language-text\">@Transational</code> 애노테이션을 사용할 때 <code class=\"language-text\">영속성 컨텍스트</code>를 가져와 트랜잭션 처리를 위해 <code class=\"language-text\">데이터베이스 커넥션을 획득</code>한다. </p>\n<p>OSIV는 트랜잭션이 끝나도 영속성 컨텍스트를 유지하고 있다. 즉 트랜잭션 범위 외에도 <code class=\"language-text\">엔티티 조회</code>가 가능하다. 이것이 의미하는 바는 데이터베이스 커넥션을 계속 붙들고 있다는 것을 의미한다. 그림으로 표현하면 아래와 같다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/babb82ddf0b7ffb22c504c08ce035334/955c5/3.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 45.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABfklEQVR42lWS63KCQAyF+/5P1d+d6UxxRKgilAqCctsFlYuyp0kQtZnJ7C375Wyyb3ixYRjQtq2Mfd/LfBxHOeO11hpVVaEsS/GiKJDnuXiSJBL3NsOapoHv+1gul3AcB7Ztw7IsCeTLWZYJgF0pJfCa7nDypjnhcDhMQGMMuq6TwPV6jTAMJZidg3idpik0QQ407uMYKSU5EazIM8TRDtFuJwkfCo/HI6IogrVYiDJWxBDP8+C6rpyFvztsgx9s/AA+zeOEzoMQC9uBu9kKkMUJ0Lw8O6esSlWShNWw3foOXn7CVwHY5YhvZeDUQN6OOF8N6mF8PlmARL6RM1jXJ+xTgpGCrCinvXOLo2rQ0qK9TX4h0Gj47iSIBUw1vKvLWoiCz/0FH6HCu6+wra7QV2CvO0RFAz0AZWegyOt+coYz+AGcu8ybHR1SYpnPIxs3jcsxv2Y2Q19K66njXOd/wKeZh5t7dXv6Glz0ijrNDcv5+9DIqviLrVYrBEEgsX8C/bBPXnLrpQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='3' title='' src='/static/babb82ddf0b7ffb22c504c08ce035334/ca1dc/3.png' srcset='/static/babb82ddf0b7ffb22c504c08ce035334/e7570/3.png 170w,\n/static/babb82ddf0b7ffb22c504c08ce035334/f46e7/3.png 340w,\n/static/babb82ddf0b7ffb22c504c08ce035334/ca1dc/3.png 680w,\n/static/babb82ddf0b7ffb22c504c08ce035334/02d09/3.png 1020w,\n/static/babb82ddf0b7ffb22c504c08ce035334/9d567/3.png 1360w,\n/static/babb82ddf0b7ffb22c504c08ce035334/955c5/3.png 1824w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>OSIV는 뷰에서 영속성 컨텍스트를 유연하게 활용할 수 있어서 다양한 이점을 누릴 수 있다. 다만 <code class=\"language-text\">Interceptor</code>이후 동작하는 <code class=\"language-text\">ArgumentResolver</code>에서 트랜잭션을 활용할 경우 성능 상에 문제가 발생할 수 있다.</p>\n<p>아래는 Spring MVC를 간소화한 그림이다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/4cf1438c13cd2485c1719ca87c36a7f9/70841/4.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 39.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDElEQVR42p1R24qDUBDz/z+qglAQtagPWqstaiveKGLx0puaJQM+dJ+6OzDM0RwzSVTwh3q9Xng+nzLv97v071K+JVuWBdfrFdvtFqqqYrfbwXEczPP8P8JhGNA0DU6nEyzLQlmWOB6PmKbpe0KqYrNIFIYhqqpCHMc4n88yqfqDkBsej4dkw0yoZCWhHWK32w2Hw+EDY/Fb27aR57nce7/fUPq+FwvMRdd1GIaBtm0xjiO6rhMlm80GpmkKKVVxMbEsy6BpmuTquq48K3Vdiw1uWm0QCIJAel3IM+1x0r7v+3LP8zw57/d7FEUBhUETSNNUmoRr0LS6YnzPpu31J1HA5XJBkiSIokhU/wAWuV5ePKyrKQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='4' title='' src='/static/4cf1438c13cd2485c1719ca87c36a7f9/ca1dc/4.png' srcset='/static/4cf1438c13cd2485c1719ca87c36a7f9/e7570/4.png 170w,\n/static/4cf1438c13cd2485c1719ca87c36a7f9/f46e7/4.png 340w,\n/static/4cf1438c13cd2485c1719ca87c36a7f9/ca1dc/4.png 680w,\n/static/4cf1438c13cd2485c1719ca87c36a7f9/02d09/4.png 1020w,\n/static/4cf1438c13cd2485c1719ca87c36a7f9/70841/4.png 1094w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><code class=\"language-text\">ArgumentResolver</code>를 등록하면 핸들러로 들어온 데이터를 추가 가공하는 등의 <code class=\"language-text\">전처리 작업</code>을 진행할 수 있다. 보통 회원의 존재 여부와 같이 인증이 필요한 부분에 공통적으로 활용할 수 있는데, 이때 회원이 존재하는지 확인하기 위해 <code class=\"language-text\">데이터베이스</code>를 필요로 하는 경우 문제가 발생할 수 있다.</p>\n<p>가령 아래와 같은 <code class=\"language-text\">ArgumentResolver</code>가 있다고 가정한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthenticationPrincipalArgumentResolver</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerMethodArgumentResolver</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AuthService</span> authService<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthenticationPrincipalArgumentResolver</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">AuthService</span> authService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>authService <span class=\"token operator\">=</span> authService<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">supportsParameter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">MethodParameter</span> parameter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> parameter<span class=\"token punctuation\">.</span><span class=\"token function\">hasParameterAnnotation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthenticationPrincipal</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">resolveArgument</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">MethodParameter</span> parameter<span class=\"token punctuation\">,</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ModelAndViewContainer</span> mavContainer<span class=\"token punctuation\">,</span>\n                                  <span class=\"token keyword\">final</span> <span class=\"token class-name\">NativeWebRequest</span> webRequest<span class=\"token punctuation\">,</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">WebDataBinderFactory</span> binderFactory<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">HttpServletRequest</span> request <span class=\"token operator\">=</span> webRequest<span class=\"token punctuation\">.</span><span class=\"token function\">getNativeRequest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> accessToken <span class=\"token operator\">=</span> <span class=\"token class-name\">AuthorizationExtractor</span><span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Long</span> id <span class=\"token operator\">=</span> authService<span class=\"token punctuation\">.</span><span class=\"token function\">extractMemberId</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginMember</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">@AuthenticationPrincipal</code> 애노테이션이 붙은 매개변수를 채우기 이전에 <code class=\"language-text\">authService.extractMemberId(accessToken)</code>을  통해 회원의 정보를 추출하고 있다. 해당 메서드 내부에서는 데이터베이스 트랜잭션을 통해 회원 정보를 조회하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>readOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Long</span> <span class=\"token function\">extractMemberId</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Long</span> memberId <span class=\"token operator\">=</span> tokenCreator<span class=\"token punctuation\">.</span><span class=\"token function\">extractPayload</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">validateExistsById</span><span class=\"token punctuation\">(</span>memberId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> memberId<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">extractMemberId()</code> 메서드는 <code class=\"language-text\">@Transactional(readOnly = true)</code>을 통해 읽기 전용으로 트랜잭션을 활용하고 있다.</p>\n<p>그렇다면 이러한 상황에서 어떠한 문제가 발생할까? OSIV는 <code class=\"language-text\">트랜잭션 시작 시점</code>에 <code class=\"language-text\">데이터베이스 커넥션을 획득</code>한다. 즉 <code class=\"language-text\">ArgumentResolver</code>에서 회원 검증을 위한 조회 로직을 수행하는 시점에 데이터베이스 커넥션을 획득한다는 것이다. 이것을 다시 한 번 그림으로 살펴보자.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/052bc09cbf431fe4e2ac43cee31eb1c4/8d416/5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 41.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjElEQVR42n2S2a6bUAxF8/+f1acqja5SmgQaQhjSBDiHMQwhTKu+oFbqSy1Z2zb7WPISm2EYeHcd/XvNz3oQ7V4tKo4JHw/RSPROmmiyNFn6OIqIonDRRCvC8EGapmzquibJcnyV80vn3HXGTdTxArYfe77uPtjtjaU2bQeVFkRJJpqjs4K0eFK3newoUEqxQaKfQHWQ9VAOqwah4svOYHeyZTajmh7Lv1ONUIn/UxvRVlKe0AwjSZKwmVljnif+xEvOtUyT0/EgeuLqXHDsM57rroZJvH/985LjOKC1LGzkZOdi43sukwxb6Y+HA657XYxFnvNtu+V2C4RfyrMs0XKaUjHD0C/fY2EdCUutNZtQmH2YF/aWQyAcTe/Bd/PM0b4SCa+zG2BYNsefl6W+eDfOVx/b9VHC7eoH2I68DYJ1YdFN/EgnrHzEa8AqJuJ2pOhGauFUvidy8ZSSUVZSCfCnzBrRfmE3U73eNO1rXcg/MfO/viwLqmdJXT2X08uikF9GczodMQxDsNz4DWX8XLFg+SwfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='5' title='' src='/static/052bc09cbf431fe4e2ac43cee31eb1c4/ca1dc/5.png' srcset='/static/052bc09cbf431fe4e2ac43cee31eb1c4/e7570/5.png 170w,\n/static/052bc09cbf431fe4e2ac43cee31eb1c4/f46e7/5.png 340w,\n/static/052bc09cbf431fe4e2ac43cee31eb1c4/ca1dc/5.png 680w,\n/static/052bc09cbf431fe4e2ac43cee31eb1c4/02d09/5.png 1020w,\n/static/052bc09cbf431fe4e2ac43cee31eb1c4/9d567/5.png 1360w,\n/static/052bc09cbf431fe4e2ac43cee31eb1c4/8d416/5.png 1958w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>한 번 획득한 <code class=\"language-text\">데이터베이스 커넥션</code>은 OSIV 설정으로 인해 지정 범위까지 유지된다. 즉 트랜잭션 범위 내에서만 데이터베이스 커넥션이 유지되는 것이 아니라 <code class=\"language-text\">요청 중 최초</code>에 지정된 커넥션을 재사용하기 때문에 오랜시간 동안 커넥션 자원을 사용하는 것이다.</p>\n<p>보통 데이터베이스와 연결을 위한 커넥션 자원을 비싼 비용을 가지고 있다. 이것을 절약하기 위해 커넥션 풀에 일정 개수의 커넥션을 생성한 뒤 재사용하는 방식을 활용하곤 한다. 결국 커넥션은 <code class=\"language-text\">한정된 자원</code>이다. 오랜시간 커넥션을 물고 있다는 것은 <code class=\"language-text\">병목</code>이 발생할 가능성이 커진다는 것을 의미한다. 다수의 요청이 발생할 경우 커넥션을 획득하지 못한 요청은 <code class=\"language-text\">대기</code>하게 될 것이다. 모든 케이스에 해당하는 것은 아니지만 실시간 트래픽이 중요한 애플리케이션의 경우 커넥션의 개수가 부족하여 장애로 이어질 수 있다.</p>\n<h2>정리</h2>\n<p>OSIV는 영속성 컨텍스트의 생존 범위를 늘려주어 엔티티 <code class=\"language-text\">Lazy Loading</code>과 같은 다양한 이점을 누릴 수 있다. 스프링을 사용할 경우 OSIV를 비즈니스 계층 트랜잭션으로 활용하여 보다 더 안정적으로 영속성 컨텍스트를 활용할 수 있다.</p>\n<p>하지만 이러한 이점을 누리기 위해서는 오랜시간 데이터베이스 커넥션을 활용해야 한다. 실시간 트래픽이 주가 되는 애플리케이션의 경우 한정된 커넥션 개수가 부족하여 장애로 이어질 수 있음을 염두해 두어야 한다.</p>\n<h2>References.</h2>\n<p><a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/orm/jpa/support/OpenEntityManagerInViewInterceptor.html\">OpenEntityManagerInViewInterceptor</a><br/>\n김영한 지음, 『자바 ORM 표준 JPA 프로그래밍』, 에이콘(2015), p593-607.</p>","frontmatter":{"title":"OSIV와 사용하며 직면한 문제","date":"October 24, 2022","update":"October 24, 2022","tags":["우아한테크코스","OSIV","JPA"],"series":null},"fields":{"slug":"/osiv/","readingTime":{"minutes":13.89}}},"seriesList":{"edges":[{"node":{"id":"2dac6856-47a1-5ef0-9c9f-d69d4234afcf","fields":{"slug":"/why-jdbc-template/"},"frontmatter":{"title":"JdbcTemplate는 어디에?"}}},{"node":{"id":"b77737b7-c888-54d0-8901-9921b4bbb703","fields":{"slug":"/spring-jdbc-batch/"},"frontmatter":{"title":"Spring JDBC로 batch 활용하기"}}},{"node":{"id":"59e94329-3d48-53b9-9995-90d61432234d","fields":{"slug":"/local-date-time/"},"frontmatter":{"title":"java에서 날짜, 시간 제대로 사용하기"}}},{"node":{"id":"c8dda97d-41c7-5596-a0c8-703fd69d92e7","fields":{"slug":"/identity-strategy/"},"frontmatter":{"title":"IDENTITY 전략는 추가 조회를 하지 않을 수 있다."}}},{"node":{"id":"c50af7e8-5953-5168-b4af-1d186a4254a7","fields":{"slug":"/separated-interface/"},"frontmatter":{"title":"외부와 의존성 분리하기"}}},{"node":{"id":"ba9d009e-d6e8-574f-9f7b-89819e3e57ca","fields":{"slug":"/properties-to-object/"},"frontmatter":{"title":"properties 객체로 다루기"}}},{"node":{"id":"7b780208-a850-5305-a51c-f0937cbdaf93","fields":{"slug":"/google-refresh-token/"},"frontmatter":{"title":"Google은 Refresh Token을 쉽게 내주지 않는다."}}},{"node":{"id":"58f32f4d-b2d6-54d6-b3dd-cb4cf4da1d70","fields":{"slug":"/basic-tomcat/"},"frontmatter":{"title":"Tomcat"}}},{"node":{"id":"d26e840e-0646-5dd9-a2d5-5670ddc81ede","fields":{"slug":"/jdbc/"},"frontmatter":{"title":"JDBC"}}},{"node":{"id":"e0a32367-096e-595a-9580-0d3d2fc6e9aa","fields":{"slug":"/template-callback/"},"frontmatter":{"title":"jdbcTemplate을 만들며 마주한 Template Callback 패턴"}}},{"node":{"id":"cf3a2936-1b1f-5d11-832e-dbb9f8051755","fields":{"slug":"/osiv/"},"frontmatter":{"title":"OSIV와 사용하며 직면한 문제"}}},{"node":{"id":"53859931-2807-5303-a90d-33df33a856de","fields":{"slug":"/save-persist-merge/"},"frontmatter":{"title":"SimpleJpaRepository의 save()는 어떻게 새로운 엔티티를 판단할까?"}}},{"node":{"id":"09a96ca9-bb95-55ab-83cf-d9d053b2ad70","fields":{"slug":"/optimistic-locking/"},"frontmatter":{"title":"낙관적 락과 동시성 테스트"}}},{"node":{"id":"647737e4-08ec-5813-a092-c27ef1da4292","fields":{"slug":"/java-string/"},"frontmatter":{"title":"문자열 생성 방식 비교하기"}}},{"node":{"id":"696ee6ba-c2ea-5e8b-a25f-aaa4eccfa5e9","fields":{"slug":"/2022-retrospect/"},"frontmatter":{"title":"조금 늦은 2022년 회고"}}},{"node":{"id":"5a61e41a-16ff-5669-bf0e-028ea40e0af3","fields":{"slug":"/jpa-auditing/"},"frontmatter":{"title":"Spring Data JPA Auditing"}}}]},"previous":{"fields":{"slug":"/template-callback/"},"frontmatter":{"title":"jdbcTemplate을 만들며 마주한 Template Callback 패턴"}},"next":{"fields":{"slug":"/save-persist-merge/"},"frontmatter":{"title":"SimpleJpaRepository의 save()는 어떻게 새로운 엔티티를 판단할까?"}}},"pageContext":{"id":"cf3a2936-1b1f-5d11-832e-dbb9f8051755","series":null,"previousPostId":"e0a32367-096e-595a-9580-0d3d2fc6e9aa","nextPostId":"53859931-2807-5303-a90d-33df33a856de"}},"staticQueryHashes":[],"slicesMap":{}}