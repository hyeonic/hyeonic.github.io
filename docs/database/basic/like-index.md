---
title: "íŠ¹ì • LIKE ì¡°ê±´ì„ ì¸ë±ìŠ¤í•  ìˆ˜ ì—†ëŠ” ì´ìœ "
tags: ['ìš°ì•„í•œí…Œí¬ì½”ìŠ¤', 'LIKE', 'ì¸ë±ìŠ¤']
date: 2022-09-27 12:00:00
feed:
  enable: true
---

# íŠ¹ì • LIKE ì¡°ê±´ì„ ì¸ë±ìŠ¤í•  ìˆ˜ ì—†ëŠ” ì´ìœ 

`B-Tree` ì¸ë±ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬`ë˜ê¸° ë•Œë¬¸ì— ì™¼ìª½ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¥¸ìª½ ê°’ì´ ì •ë ¬ëœë‹¤. ì´ëŸ¬í•œ íŠ¹ì •ìœ¼ë¡œ ì¸í•´ íŠ¹ì • `LIKE` ì¡°ê±´ì„ ì‚¬ìš©í•  ë•Œ ì¸ë±ìŠ¤ë¥¼ ì ìš©í•  ìˆ˜ ì—†ë‹¤.

- `LIKE â€˜%matâ€™`
- `LIKE â€˜_matâ€™`
- `LIKE â€˜%mat%â€™`

ì•„ë˜ì™€ ê°™ì€ í…Œì´ë¸”ì´ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.

```sql
mysql> DESC members;
+-------------------+--------------+------+-----+-------------------+-------------------+  
| Field             | Type         | Null | Key | Default           | Extra             |  
+-------------------+--------------+------+-----+-------------------+-------------------+  
| id                | bigint       | NO   | PRI | NULL              | auto_increment    |  
| email             | varchar(255) | NO   | MUL | NULL              |                   |  
| display_name      | varchar(255) | NO   |     | NULL              |                   |  
| profile_image_url | varchar(255) | NO   |     | NULL              |                   |  
| social_type       | varchar(255) | NO   |     | NULL              |                   |  
| created_at        | timestamp    | NO   |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED |  
| updated_at        | timestamp    | NO   |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED |  
+-------------------+--------------+------+-----+-------------------+-------------------+  
```

`email` ì¹¼ëŸ¼ì— ì¸ë±ìŠ¤ë¥¼ ì„¤ì •í•œë‹¤.

```sql
mysql> ALTER TABLE employees ADD INDEX idx_employees_first_name (first_name);
```

ì´ê²ƒì„ ê·¸ë¦¼ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

![](./like-index/email-index.png)

í•´ë‹¹ ì¸ë±ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¡°íšŒë¥¼ ì§„í–‰í•  ë•ŒëŠ” `ì €ì¥ëœ ê°’ì˜ ì™¼ìª½` ë¶€í„° í•œ ê¸€ìì”© ë¹„êµí•´ê°€ë©° ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œë¥¼ ì°¾ì•„ê°„ë‹¤.


![](./like-index/read-email-index.png)

ë§Œì•½ ì•„ë˜ì™€ ê°™ì€ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œë‹¤ê³  ê°€ì •í•œë‹¤.

```sql
mysql> SELECT * FROM members WHERE email LIKE '%mat%';
```

ìœ„ ì¿¼ë¦¬ëŠ” `ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº”` ë°©ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ìœ ëŠ” `email` ì¹¼ëŸ¼ì— `ì €ì¥ëœ ê°’ì˜ ì™¼ìª½`ë¶€í„° í•œ ê¸€ìì”© ë¹„êµí•´ê°€ë©° ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ”ë°, ì¡°ê±´ì ˆì— ì£¼ì–´ì§„ ê°’ì€ ì™¼ìª½ ë¶€ë¶„ì´ ê³ ì •ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤.

ì‹¤ì œ ì‹¤í–‰ ê³„íšì„ ì‚´í´ë³´ì•„ë„ `í’€ í…Œì´ë¸” ìŠ¤ìº”`ì„ ì§„í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```sql
mysql> EXPLAIN SELECT * FROM members m WHERE m.email LIKE '%mat%';
+----+-------------+-------+------------+------+---------------+------+---------+------+---------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows    | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+---------+----------+-------------+
|  1 | SIMPLE      | m     | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 9421768 |    11.11 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+---------+----------+-------------+
```

# Full Text search

ê·¸ë ‡ë‹¤ë©´ `íŠ¹ì • ë¬¸ìì—´ì„ í¬í•¨í•˜ëŠ” ë ˆì½”ë“œ`ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ì„œëŠ” ë¬´ì¡°ê±´ `í’€ í…Œì´ë¸” ìŠ¤ìº”`ì„ ì§„í–‰í•´ì•¼ í•˜ëŠ”ê°€? MySQLì˜ InnoDBë‚˜ MyISAMì€ ë¬¸ì„œ ì „ì²´ì— ëŒ€í•œ ë¶„ì„ê³¼ ê²€ìƒ‰ì„ ìœ„í•œ ì¸ë±ì‹± ì•Œê³ ë¦¬ì¦˜ì¸ `ì „ë¬¸ ê²€ìƒ‰(Full Text search)`ë¥¼ ì œê³µí•œë‹¤. `ì „ë¬¸ ê²€ìƒ‰`ì„ í™œìš©í•˜ë©´ ì•ì„œ ì–¸ê¸‰í•œ `íŠ¹ì • LIKE ì¡°ê±´`ì— ì¸ë±ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆëŠ” ëŒ€ì•ˆì´ ë  ìˆ˜ ìˆë‹¤.

ì „ë¬¸ ê²€ìƒ‰ì„ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì•¼ í•œë‹¤.

```sql
mysql> ALTER TABLE members ADD FULLTEXT (email);
```

ìƒì„±ëœ ì¸ë±ìŠ¤ë¥¼ í™•ì¸í•œë‹¤.

```sql
mysql> SHOW INDEX FROM members;
+---------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table   | Non_unique | Key_name          | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+---------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| members |          0 | PRIMARY           |            1 | id          | A         |     9421768 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| members |          1 | email             |            1 | email       | NULL      |     9915796 |     NULL |   NULL |      | FULLTEXT   |         |               | YES     | NULL       |
+---------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
```

ìƒì„±í•œ ì¸ë±ìŠ¤ëŠ” `WHERE` ì ˆì— íŠ¹ìˆ˜í•œ ë©”ì„œë“œ(e.g. `MATCH()`, `AGAINST()`)ë¥¼ í™œìš©í•´ì•¼ í•œë‹¤. 

```sql
mysql> EXPLAIN SELECT * FROM members m WHERE MATCH(m.email) AGAINST('ab*' IN BOOLEAN MODE);
+----+-------------+-------+------------+----------+---------------+-------+---------+-------+------+----------+-----------------------------------+
| id | select_type | table | partitions | type     | possible_keys | key   | key_len | ref   | rows | filtered | Extra                             |
+----+-------------+-------+------------+----------+---------------+-------+---------+-------+------+----------+-----------------------------------+
|  1 | SIMPLE      | m     | NULL       | fulltext | email         | email | 0       | const |    1 |   100.00 | Using where; Ft_hints: no_ranking |
+----+-------------+-------+------------+----------+---------------+-------+---------+-------+------+----------+-----------------------------------+
```

ì‹¤í–‰ ê³„íšì˜ `type`ì„ ì‚´í´ë³´ë©´ `fulltext`ë¥¼ í™œìš©í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ìì„¸í•œ ì‚¬ìš© ë°©ë²•ì€ ì¶”í›„ í•™ìŠµì„ í†µí•´ ì¶”ê°€í•  ì˜ˆì •ì´ë‹¤.

## References.

ë°±ì€ë¹ˆ, ì´ì„±ìš±, ã€Real MySQL 8.0ã€, ìœ„í‚¤ë¶ìŠ¤(2021), p249. <br>
[[MYSQL] ğŸ“š í’€í…ìŠ¤íŠ¸ ì¸ë±ìŠ¤(Full-Text Index) ì‚¬ìš©ë²•](https://inpa.tistory.com/entry/MYSQL-%F0%9F%93%9A-%ED%92%80%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%9D%B8%EB%8D%B1%EC%8A%A4Full-Text-Index-%EC%82%AC%EC%9A%A9%EB%B2%95)

<TagLinks />
